{"instances":{"application":{"persistent":false},"Navbar/0-0-0-1":{"tabs":[{"title":"Blog","href":"/blog"},{"title":"About me","href":"/me"}],"showDropdown":false,"persistent":false},"Home/0-0-0-2-0/":{"links":[{"name":"github","link":"https://github.com/victorfernandesraton"},{"name":"linkedin","link":"https://linkedin.com/in/vraton"},{"name":"mastodon","link":"https://mastodon.social/@ratondev"}],"description":"Wellcome to my personal chaos","persistent":false},"PostList/0-0-0-2-0-0-2":{"postList":[{"title":"Creating this blog","description":"Nullstack - A journey of Simplicity and Flexibility","published_at":"2023-06-21T00:00:00.000Z","cover":"/public/assets/img/nulla-tools.webp","name":"creating-this-blog","url":"undefined/blog/creating-this-blog","body":"# A big dsclaimer first\n\n![image](/assets/img/nulla-tools.webp)\n\nExploring the vast array of JavaScript frameworks such as React, Vue, Angular, and Svelte, I encountered limitations, vendor lock-in issues, and the overwhelming chaos of the JavaScript ecosystem, with its countless dependencies and conflicting solutions. However, amidst this tumult, my discovery of Nullstack brought a ray of hope. Initially seen as unconventional due to its use of ES6 classes and named methods for component cycles, I soon recognized the brilliance and potential of this framework.\n\nNullstack stands out for its refreshing simplicity, offering streamlined data management through class props rather than convoluted states. One remarkable feature is its superior application context, which eliminates the need for a Redux store. Notably, Nullstack goes beyond the capabilities of Next.js by providing built-in support for progressive web app (PWA) capabilities without the need for additional dependencies, resulting in improved SEO capabilities.\n\nBut the greatness of Nullstack extends further. It offers the flexibility to adapt to various application architectures, be it single-page applications (SPAs), static HTML, or Node servers with Express. What truly sets it apart is its lack of vendor lock-in, allowing projects to run seamlessly across diverse infrastructures, from on-premises to cloud-based environments. In a world rife with complexity and uncertainty, Nullstack emerges as a great solution, offering clarity and stability for web developers seeking an alternative path.\n\n# Getting start\n\nNullstack is very consistent, because of this structure, everything in nullstack is based on things is were worked well along side the internet, isntead of create something like css module, for default nullstack support css and sass style.\n\nFor create and manager your aplication, you don´t need handle with complex stuff like vite , webpack or babel, Nullstack have a npx tool to create application , with is have some things on a opitional support like tailwind, typescript and sass support, is a convension over configuration like \n\n\n# First of all: Folder design\n\nThe first thing i start love in nullstack is about freedom, unlike next.js or angular you don´t have a definitive folder structure. According the documentation, the only thing you need is:\n\n- A client.js file witch is used for loading global client stuff, like added a global event or consume an browser api like Localstorage\n- A server.js file witch is used for loading server side things like enviroment virables, connect an api or even write an http endpoint (because the second great thing about nullstack, in terms of runtime is a simple express server running in Node.js with is have all libs you are loved)\n- A Application.js/jsx/njs file because is like React, a App.js file for initialize your application\n\nthis structure is result of building project using the only nad recomended way, nullstack-create-app cli, you can lean more about this [in nullstack documentation](https://nullstack.app/getting-started)\n\nfor this project i use the command above\n\n```bash\nnpx create-nullstack-app@latest project-name -tw\n```\n\nYep, i don´t use typescript in this project because seens like overrated for this....\n\nNow in project-name i can see a similar structure like this this structure\n\n```txt\n- src\n-- Application.jsx\n-- Application.css\n-- Counter.jsx\n-- Home.jsx\n- server.js\n- client.js\n- tailwind.config.js\n- tailwind.css\n- package.json\n```\n\nnext them i added some changes in my tailwind config file for support rose-pine thene and my fonts \n\nfor this project the first thing i do is added support or rose-pine colors (you can see my [tailwind.config.js](https://github.com/victorfernandesraton/victorfernandesraton.github.io/blob/e8da50419b66dd70bca2b838186df9ca03b4e4ea/tailwind.config.js))\n\n\nthe second one is create the post structure, it's a simple and very stupid idea, i create a folder called posts, and added some markdowns file wittch i use the filename as a subpath in my blog section, so for create a simple post i added a post here\n\n\nthe idea is using a node.js file systens functions to read this markdown and apply some styles using marked library (and some things is not work as well as you can see)\n\nthe first implementation is your post component, because there we create to functions, one for get post and metadata for file and another to walk thorought the directory post and create a list of post, i mean content and metadata\n\nFor access blog content you use /blog/some-post path, and they verify and get in /posts/some-post.md for contenrt\n\n# Almost perfect\n\nI know this is not performatic way to do this because of two things\n- The function for walking in directory is not optimized at all, also witch means we need iterate to every post and dcopllect every metadata and content like we do for show them, it's means , the scaklability of build time is incresead every time when i creating posts\n- I need call all posts at once if i make this avaliable in SSG, because when i build one page, i need to call in prepare or initialize all posts and they not is performatic to show this list in to or many places\n\nFor you know about this , you need read Nullstack documentation about static and server side function, for now, you should know we create two server side GET functions, it's cool because since we move to SSR mode, nullstack generate a GET endpoint api for make requests, of course the path is a dibrish string , but if you need it's a very welll endpoint you should read more about server initialization in doc\n\nfor now i wrote a simple post component, like this\n\n```js\nimport Nullstack from 'nullstack'\n\nimport fm from 'front-matter'\nimport { existsSync, readFileSync } from 'node:fs'\nimport fs from 'node:fs/promises'\nimport path from 'node:path'\n\nclass Post extends Nullstack {\n\n  // itś a server side function witch will avaliable as endpoint later\n  static async getPost({ key }) {\n    const path = `posts/${key}.md`\n    if (!existsSync(path)) {\n      return null\n    }\n    const data = readFileSync(path, 'utf-8')\n\n    const { attributes, body } = fm(data)\n\n    return {\n      html: body,\n      name: key,\n      ...attributes,\n    }\n  }\n\n  // also another server side tunction, but in this case we need pass context paramas for using proxy\n  static async getAllPost(context) {\n    const directoryPath = 'posts'\n    const files = await fs.readdir(directoryPath)\n    const filteredFiles = []\n    for (const file of files) {\n      const filePath = path.join(directoryPath, file)\n      const fileStats = await fs.stat(filePath)\n\n      if (fileStats.isFile() && path.extname(file) === '.md') {\n        const data = await Post.getPost({ ...context, key: file.replace('.md', '') })\n        filteredFiles.push(data)\n      }\n    }\n    return filteredFiles\n  }\n\n  // initiate in some times run in server side like when you access link directly, or loading in client side if you access link navigating in site, See more in https://developer.chrome.com/docs/web-platform/declarative-link-capturing/\n\n  async initiate({ page, params, router }) {\n    const article = await Post.getPost({\n      key: params.slug !== '' ? params.slug : router.path.slice(1),\n    })\n\n    page.title = article.title\n    if (article?.description) {\n      page.description = article.description\n    }\n    if (article?.cover) {\n      page.image = article.cover.replace('/public', '')\n    }\n    Object.assign(this, article)\n  }\n\n  render({ router }) {\n    if (!this.html && this.initiated) {\n      router.path = '/404'\n    }\n\n    return (\n      <>\n        <header class=\"mx-auto mb-16 mt-8 max-w-[900px] flex flex-col gap-y-4 content-between break-words\">\n          <h1 class=\"text-4xl font-bold text-rosePine-love\">{this?.title}<\\/h1>\n          {this.description && <h2 class=\"text-2xl font-bold text-rosePine-gold mb-4\">{this?.description}<\\/h2>}\n        <\\/header>\n        <article html={this.html} class=\"mx-auto max-w-[900px]\" />\n      <\\/>\n    )\n  }\n\n}\n\nexport default Post\n```\n\nas you can se, we wrote less tham 100 lines and this is almost everything we need for blog\n\nthe function `getPost` is a server side function witch receiver key arg, this ar is a name for file , also is a path for this post in page blog , it's like a node.js function witch go to specific path and find if this file exists \n\nif were is we use a library called [front-matter](https://github.com/jxson/front-matter) for extract some markdown meatda\n\nthe function `getAllPost` is for search all posts and putting in a list, but is not called here, i mantaining here because is more simple to move them to another component, since this component is everythong about post\n\nin initiate method is were magic is work, they called getPost using a router slug to get path fot this post, \nfor now in this way, we not allowed to have subpath in posts directory.\n\nthe method `Object.assign` is useful here, since everything in nullstack is proxable , using this way we sure wen the function initiate is ending, they had article object  assign with post content and meatada\n\nand the last lines is like a react jsx, we know there, get some props and render them\n\nnow, we need to setup a blog router and home page\n\nIn render method is were the main component is render and you see a litle condition , if dont have any content, go to 404 page, as you can see, in nullstack router object is avaliable in every client side cycle injectable by framework, just change the path to redirect interal path, if you need a external redirect , you can use router.url instead\n\n\n# Router is never be eazy\n\nNow, we need make some changes in  `src/Application.jsx` file, because this is entry point for front end\n\n\nfor now we just add a /blog path and some navbar element\n\n```js\nimport Nullstack from 'nullstack'\n\nimport '../tailwind.css'\nimport Home from './Home'\nimport Post from './Post.jsx'\n\nclass Application extends Nullstack {\n\n  postList = []\n  async initiate({ limit }) {\n    this.postList = await Post.getAllPost()\n    if (limit) {\n      this.postList = this.postList.slice(0, limit)\n    }\n  }\n\n  renderHead() {\n    return (\n      <head>\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\" />\n      <\\/head>\n    )\n  }\n\n  renderFooter() {\n    return (\n      <footer class=\"pt-6 flex flex-col max-w-[900px] mx-auto my-8 inset-x-0 bottom-0 lg:items-start items-center gap-4 text-center lg:text-start border-t-rosePine-surface border-t-[1px]\">\n        <p>Developed with &#128156; by victorfernandesraton<\\/p>\n      <\\/footer>\n    )\n  }\n\n  renderBody({ children }) {\n    return (\n      <>\n        <Head />\n        <ul>\n          <li>\n            <a href=\"/\">Home<\\/a>\n          <\\/li>\n          {this.postList\n            .slice(0)\n            .sort((a, b) => b.published_at >= a.published_at)\n            .map((i) => (\n              <li>\n                <a href={`/blog/${i.name}`}>{i.title}<\\/a>\n              <\\/li>\n            ))}\n        <\\/ul>\n        <body class=\"bg-rosePine-base text-rosePine-text lg:px-0 px-4 h-fulli\">{children}<\\/body>\n        <Footer />\n      <\\/>\n    )\n  }\n\n  render({ router }) {\n    return (\n      <Body>\n        <Home route=\"/\" />\n        <Post route=\"/blog/:slug\" key={router.path} />\n      <\\/Body>\n    )\n  }\n\n}\n\nexport default Application\n```\n\nAs you can see i also adding footer , body and navbar component, most for organization\n\nAnd i using initiate method again for get a list of existing posts, and render in List component, it's very simple\n\nAs you can see in render of application, whe using route params, is very eazy to create routers and subrouters in nullstack, you see more [here](https://nullstack.app/routes-and-params)\nNow just need create some post, a markdown file with headers information like this\n\n```markdown\n---\ntitle: About me\ndescription: console.log('hello world')\npublished_at: 2023-05-15\ncover: /public/assets/img/profile.webp\n---\n\n\n# Hey guys!\n\nMy name is Victor Raton (some call me Baião), and I'm a Brazilian full-stack developer. When I'm not procrastinating or coming up with some side project that will be forgotten, I like to share my ideas here, covering topics such as web development, Linux, productivity, and even my hobbies, like playing metroidvanias or researching and customizing keyboards\n\nI started studying software development in 2018, the same year I entered my first Computer Science degree. The following year, I began working as a full-stack developer, mostly with JavaScript.\n\nI've decided to write more about technology in order to improve my skills.\n\n\n```\n\nFor least and less important, we need adding some markdowen support, fr this i suing [marked](https://github.com/markedjs/marked), a markdown parser solution with works in server side.\n\nFor separation concerm, i create this adapter in `/lib/markdown/MarkedAdapter.js`, in this case i use class but you also can build using functions too \nMaybe you can see my entire solution using highlight.js for adding code highlight support here\n\nbut for now we kept simple:\n\n```js\nimport { marked } from 'marked'\nexport class MarkedAdapter {\n\n  static replaceImageUrl({ md }) {\n    const regex = /(!\\[[^\\]]*]\\([^)]*)\\/public(\\/[^)]+\\))/g\n\n    return md.replace(regex, '$1$2')\n  }\n\n  static _heading(text, level) {\n    const className = `text-${5 - level}xl font-bold text-rosePine-iris`\n\n    return `<h${level} class=\"${className}\">${text}<\\/h${level}>`\n  }\n\n  static _listitem(body) {\n    const className = 'my-2'\n\n    return `<li class=\"${className}\">${body}<\\/li>`\n  }\n\n  static _list(body) {\n    const className = 'list-disc py-4 pl-4 marker:blue'\n\n    return `<ul class=\"${className}\">${body}<\\/ul>`\n  }\n\n  static _link(href, title, text) {\n    const className = 'text-blue-400 underline underline-offset-2'\n\n    return `<a ${title ? `title=\"${title}\"` : ''} href=\"${href}\" class=\"${className}\">${text}<\\/a>`\n  }\n\n  static _paragraph(text) {\n    const className = 'my-8 text'\n    return `<p class=\"${className}\">${text}<\\/p>`\n  }\n\n  static _start() {\n    const renderer = {\n      paragraph: MarkedAdapter._paragraph,\n      heading: MarkedAdapter._heading,\n      list: MarkedAdapter._list,\n      listitem: MarkedAdapter._listitem,\n      link: MarkedAdapter._link,\n    }\n    marked.use({\n      renderer,\n      mangle: false,\n      headerIds: false,\n    })\n\n    return marked\n  }\n\n}\n```\n\nNow using a server.js we added a singleton shared by context for server side funcions.\n\n```js\nimport Nullstack from 'nullstack'\n\nimport { readdirSync } from 'node:fs'\nimport path from 'node:path'\n\nimport { MarkedAdapter } from './lib/marked/MarkedAdapter'\nimport Application from './src/Application'\n\nconst context = Nullstack.start(Application)\n\nconst { worker } = context\n\nconst articles = readdirSync(path.join(__dirname, '../posts'))\n\n// this is a little workarround to creating prelaod paths for serviceWorker support\nworker.preload = [\n  '/',\n  ...articles.map((article) => `/blog/${article.replace('.md', '')}`).filter((article) => !article.includes('.draft')),\n]\ncontext.start = async function start() {\n  context.marked = MarkedAdapter._start()\n}\n\nexport default context\n```\n\nnext, we change some lines in post component for adding marked MarkedAdapter\n\nand we have something like this\n\n```js\nimport Nullstack from 'nullstack'\n\nimport fm from 'front-matter'\nimport { existsSync, readFileSync } from 'node:fs'\nimport fs from 'node:fs/promises'\nimport path from 'node:path'\n\nclass Post extends Nullstack {\n\n  // itś a server side function witch will avaliable as endpoint later\n  static async getPost({ key, marked }) {\n    const path = `posts/${key}.md`\n    if (!existsSync(path)) {\n      return null\n    }\n    const data = readFileSync(path, 'utf-8')\n\n    const { attributes, body } = fm(data)\n    // here parse uising to generate new html\n    const html = marked.parse(body)\n\n    return {\n      html,\n      name: key,\n      ...attributes,\n    }\n  }\n\n  // also another server side tunction, but in this case we need pass context paramas for using proxy\n  static async getAllPost(context) {\n    const directoryPath = 'posts'\n    const files = await fs.readdir(directoryPath)\n    const filteredFiles = []\n    for (const file of files) {\n      const filePath = path.join(directoryPath, file)\n      const fileStats = await fs.stat(filePath)\n\n      if (fileStats.isFile() && path.extname(file) === '.md') {\n        const data = await Post.getPost({ ...context, key: file.replace('.md', '') })\n        filteredFiles.push(data)\n      }\n    }\n    return filteredFiles\n  }\n\n  // initiate in some times run in server side like when you access link directly, or loading in client side if you access link navigating in site, See more in https://developer.chrome.com/docs/web-platform/declarative-link-capturing/\n\n  async initiate({ page, params, router }) {\n    const article = await Post.getPost({\n      key: params.slug !== '' ? params.slug : router.path.slice(1),\n    })\n\n    page.title = article.title\n    if (article?.description) {\n      page.description = article.description\n    }\n    if (article?.cover) {\n      page.image = article.cover.replace('/public', '')\n    }\n    Object.assign(this, article)\n  }\n\n  render({ router }) {\n    if (!this.html && this.initiated) {\n      router.path = '/404'\n    }\n\n    return (\n      <>\n        <header class=\"mx-auto mb-16 mt-8 max-w-[900px] flex flex-col gap-y-4 content-between break-words\">\n          <h1 class=\"text-4xl font-bold text-rosePine-love\">{this?.title}<\\/h1>\n          {this.description && <h2 class=\"text-2xl font-bold text-rosePine-gold mb-4\">{this?.description}<\\/h2>}\n        <\\/header>\n        <article html={this.html} class=\"mx-auto max-w-[900px]\" />\n      <\\/>\n    )\n  }\n\n}\n\nexport default Post\n\n```\n# TAH-DA\n\nAnd where is \na list and post render as a markdown \n\n![image](/assets/img/blog-works.gif)\n\nIts a simple blog implementation using for initial modeling for this blog, of course, along side of time , i added some styles and features, you can follow this repo and look some changes a made here.\n\n![image](/assets/img/thats-all.jpg)\n\n"},{"title":"About me","description":"console.log('hello world')","published_at":"2023-05-15T00:00:00.000Z","cover":"/public/assets/img/profile.webp","name":"me","url":"undefined/blog/me","body":"# Hey guys!\n\nMy name is Victor Raton (some call me Baião), and I'm a Brazilian full-stack developer. When I'm not procrastinating or coming up with some side project that will be forgotten, I like to share my ideas here, covering topics such as web development, Linux, productivity, and even my hobbies, like playing metroidvanias or researching and customizing keyboards.\n\nI started studying software development in 2018, the same year I entered my first Computer Science degree. The following year, I began working as a full-stack developer, mostly with JavaScript.\n\nI've decided to write more about technology in order to improve my skills.\n\n"}],"persistent":false}},"page":{"image":"/assets/img/profile.webp","status":200,"title":"undefined - Home","description":"Wellcome to my personal chaos","locale":"en-US"}}